{"version":3,"file":"posts.js","sources":["../../src/blocks/posts/posts.ts"],"sourcesContent":["import { html, render } from 'lit';\n\ninterface PostArgs {\n  postUrl: string;\n  headline?: string;\n  text?: string;\n}\n\nconst postTemplate = (args: PostArgs) => {\n  const { postUrl, headline, text } = args;\n  return html`\n    <article>\n      <a href=\"${postUrl}\" class=\"image\"><img src=\"images/pic01.jpg\" alt=\"\" /></a>\n      <h3>${headline}</h3>\n      <p>${text}</p>\n      <ul class=\"actions\">\n        <li><a href=\"${postUrl}\" class=\"button\">More</a></li>\n      </ul>\n    </article>\n  `;\n};\n\nconst template = (posts: PostArgs[]) => {\n  return posts.map((post) => postTemplate(post));\n};\n\nexport default async function (block: HTMLElement) {\n  block.innerHTML = '';\n\n  const req = await fetch(`${window.hlx.codeBasePath}/query-index.json`);\n  const response = await req.json();\n  const data = response.data\n    .filter((item) => {\n      return item.path.includes('/posts');\n    })\n    .map((item) => item.path);\n\n  const postsPreview = await Promise.all(data.map((path) => fetch(`${window.hlx.codeBasePath}${path}.plain.html`)));\n\n  const postsPreviewHtml = postsPreview.map((res) => {\n    var parser = new DOMParser();\n    return parser.parseFromString(res.text(), 'text/html');\n  });\n\n  console.log('postsPreviewHtml', postsPreviewHtml);\n\n  const posts = postsPreviewHtml.map((doc, index) => {\n    console.log('doc', doc);\n    return {\n      postUrl: `${window.hlx.codeBasePath}${data[index]}.html`,\n      headline: doc.querySelector('h1')?.innerText || doc.querySelector('h2')?.innerText,\n      text: doc.querySelector('p')?.innerText,\n    };\n  });\n\n  console.log('posts', posts);\n\n  block.style.removeProperty('display');\n  render(template(posts), block);\n}\n"],"names":["postTemplate","args","postUrl","headline","text","html","template","posts","post","block","data","item","postsPreviewHtml","path","res","parser","doc","index","_a","_b","_c","render"],"mappings":"iEAQA,MAAMA,EAAgBC,GAAmB,CACvC,KAAM,CAAE,QAAAC,EAAS,SAAAC,EAAU,KAAAC,CAAA,EAASH,EAC7B,OAAAI,sBAEQH,CAAO,8DACZC,CAAQ,WACTC,CAAI,wCAEQF,CAAO,+CAI9B,EAEMI,EAAYC,GACTA,EAAM,IAAKC,GAASR,EAAaQ,CAAI,CAAC,EAG/C,eAAAD,EAA+BE,EAAoB,CACjDA,EAAM,UAAY,GAIlB,MAAMC,GADW,MADL,MAAM,MAAM,GAAG,OAAO,IAAI,YAAY,mBAAmB,GAC1C,QACL,KACnB,OAAQC,GACAA,EAAK,KAAK,SAAS,QAAQ,CACnC,EACA,IAAKA,GAASA,EAAK,IAAI,EAIpBC,GAFe,MAAM,QAAQ,IAAIF,EAAK,IAAKG,GAAS,MAAM,GAAG,OAAO,IAAI,YAAY,GAAGA,CAAI,aAAa,CAAC,CAAC,GAE1E,IAAKC,GAAQ,CAC7C,IAAAC,EAAS,IAAI,UACjB,OAAOA,EAAO,gBAAgBD,EAAI,OAAQ,WAAW,CAAA,CACtD,EAEO,QAAA,IAAI,mBAAoBF,CAAgB,EAEhD,MAAML,EAAQK,EAAiB,IAAI,CAACI,EAAKC,IAAU,WACzC,eAAA,IAAI,MAAOD,CAAG,EACf,CACL,QAAS,GAAG,OAAO,IAAI,YAAY,GAAGN,EAAKO,CAAK,CAAC,QACjD,WAAUC,EAAAF,EAAI,cAAc,IAAI,IAAtB,YAAAE,EAAyB,cAAaC,EAAAH,EAAI,cAAc,IAAI,IAAtB,YAAAG,EAAyB,WACzE,MAAMC,EAAAJ,EAAI,cAAc,GAAG,IAArB,YAAAI,EAAwB,SAAA,CAChC,CACD,EAEO,QAAA,IAAI,QAASb,CAAK,EAEpBE,EAAA,MAAM,eAAe,SAAS,EAC7BY,EAAAf,EAASC,CAAK,EAAGE,CAAK,CAC/B"}
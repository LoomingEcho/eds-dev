import{j as d,x as h}from"../__chunks__/lit-element.XkUWx5ik.js";function w(i){const{src:n,alt:l,eager:r=!1,breakpoints:m=[{media:"(min-width: 600px)",width:"2000"},{width:"750"}]}=i,p=new URL(n,window.location.href),c=document.createElement("picture"),{pathname:e}=p,a=e.substring(e.lastIndexOf(".")+1);return m.forEach(t=>{const o=document.createElement("source");t.media&&o.setAttribute("media",t.media),o.setAttribute("type","image/webp"),o.setAttribute("srcset",`${e}?width=${t.width}&format=webply&optimize=medium`),c.appendChild(o)}),m.forEach((t,o)=>{if(o<m.length-1){const s=document.createElement("source");t.media&&s.setAttribute("media",t.media),s.setAttribute("srcset",`${e}?width=${t.width}&format=${a}&optimize=medium`),c.appendChild(s)}else{const s=document.createElement("img");s.setAttribute("loading",r?"eager":"lazy"),s.setAttribute("alt",l),c.appendChild(s),s.setAttribute("src",`${e}?width=${t.width}&format=${a}&optimize=medium`)}}),c}const f=i=>{const{postUrl:n,headline:l,text:r,picture:m}=i;return h`<article><a href="${n}" class="image">${m}</a><h3>${l}</h3><p>${r==null?void 0:r.slice(0,200)}</p><ul class="actions"><li><a href="${n}" class="button">More</a></li></ul></article>`},$=i=>i.map(n=>f(n));async function x(i){i.innerHTML="";const l=await(await fetch(`${window.hlx.codeBasePath}/query-index.json`)).json();console.log("response: ",l);const r=l.data.filter(e=>e.path.includes("/posts")).map(e=>e),c=(await Promise.all(r.map(async e=>(await fetch(`${window.hlx.codeBasePath}${e.path}.plain.html`)).text()))).map(e=>{var a=new DOMParser;return a.parseFromString(e,"text/html")}).map((e,a)=>{var t,o,s,u;return{postUrl:`${window.hlx.codeBasePath}${r[a].path}`,headline:((t=e.querySelector("h1"))==null?void 0:t.innerText)||((o=e.querySelector("h2"))==null?void 0:o.innerText),text:(u=(s=e.querySelector("p"))==null?void 0:s.innerText)==null?void 0:u.trim(),picture:w({src:r[a].image,alt:r[a].imagealt})}});console.log("posts: ",c),i.style.removeProperty("display"),d($(c),i)}export{x as default};
//# sourceMappingURL=posts.js.map
